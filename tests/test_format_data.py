from meteo_render.render import format_data


SAMPLE_DATA = {
    "latitude": 51.4,
    "longitude": -0.06000018,
    "generationtime_ms": 0.6250143051147461,
    "utc_offset_seconds": 0,
    "timezone": "GMT",
    "timezone_abbreviation": "GMT",
    "elevation": 57.0,
    "hourly_units": {
        "time": "iso8601",
        "temperature_2m": "°C",
        "apparent_temperature": "°C",
        "precipitation": "mm",
        "weathercode": "wmo code",
    },
    "hourly": {
        "time": [
            "2023-01-13T00:00",
            "2023-01-13T01:00",
            "2023-01-13T02:00",
            "2023-01-13T03:00",
            "2023-01-13T04:00",
            "2023-01-13T05:00",
            "2023-01-13T06:00",
            "2023-01-13T07:00",
            "2023-01-13T08:00",
            "2023-01-13T09:00",
            "2023-01-13T10:00",
            "2023-01-13T11:00",
            "2023-01-13T12:00",
            "2023-01-13T13:00",
            "2023-01-13T14:00",
            "2023-01-13T15:00",
            "2023-01-13T16:00",
            "2023-01-13T17:00",
            "2023-01-13T18:00",
            "2023-01-13T19:00",
            "2023-01-13T20:00",
            "2023-01-13T21:00",
            "2023-01-13T22:00",
            "2023-01-13T23:00",
            "2023-01-14T00:00",
            "2023-01-14T01:00",
            "2023-01-14T02:00",
            "2023-01-14T03:00",
            "2023-01-14T04:00",
            "2023-01-14T05:00",
            "2023-01-14T06:00",
            "2023-01-14T07:00",
            "2023-01-14T08:00",
            "2023-01-14T09:00",
            "2023-01-14T10:00",
            "2023-01-14T11:00",
            "2023-01-14T12:00",
            "2023-01-14T13:00",
            "2023-01-14T14:00",
            "2023-01-14T15:00",
            "2023-01-14T16:00",
            "2023-01-14T17:00",
            "2023-01-14T18:00",
            "2023-01-14T19:00",
            "2023-01-14T20:00",
            "2023-01-14T21:00",
            "2023-01-14T22:00",
            "2023-01-14T23:00",
            "2023-01-15T00:00",
            "2023-01-15T01:00",
            "2023-01-15T02:00",
            "2023-01-15T03:00",
            "2023-01-15T04:00",
            "2023-01-15T05:00",
            "2023-01-15T06:00",
            "2023-01-15T07:00",
            "2023-01-15T08:00",
            "2023-01-15T09:00",
            "2023-01-15T10:00",
            "2023-01-15T11:00",
            "2023-01-15T12:00",
            "2023-01-15T13:00",
            "2023-01-15T14:00",
            "2023-01-15T15:00",
            "2023-01-15T16:00",
            "2023-01-15T17:00",
            "2023-01-15T18:00",
            "2023-01-15T19:00",
            "2023-01-15T20:00",
            "2023-01-15T21:00",
            "2023-01-15T22:00",
            "2023-01-15T23:00",
            "2023-01-16T00:00",
            "2023-01-16T01:00",
            "2023-01-16T02:00",
            "2023-01-16T03:00",
            "2023-01-16T04:00",
            "2023-01-16T05:00",
            "2023-01-16T06:00",
            "2023-01-16T07:00",
            "2023-01-16T08:00",
            "2023-01-16T09:00",
            "2023-01-16T10:00",
            "2023-01-16T11:00",
            "2023-01-16T12:00",
            "2023-01-16T13:00",
            "2023-01-16T14:00",
            "2023-01-16T15:00",
            "2023-01-16T16:00",
            "2023-01-16T17:00",
            "2023-01-16T18:00",
            "2023-01-16T19:00",
            "2023-01-16T20:00",
            "2023-01-16T21:00",
            "2023-01-16T22:00",
            "2023-01-16T23:00",
            "2023-01-17T00:00",
            "2023-01-17T01:00",
            "2023-01-17T02:00",
            "2023-01-17T03:00",
            "2023-01-17T04:00",
            "2023-01-17T05:00",
            "2023-01-17T06:00",
            "2023-01-17T07:00",
            "2023-01-17T08:00",
            "2023-01-17T09:00",
            "2023-01-17T10:00",
            "2023-01-17T11:00",
            "2023-01-17T12:00",
            "2023-01-17T13:00",
            "2023-01-17T14:00",
            "2023-01-17T15:00",
            "2023-01-17T16:00",
            "2023-01-17T17:00",
            "2023-01-17T18:00",
            "2023-01-17T19:00",
            "2023-01-17T20:00",
            "2023-01-17T21:00",
            "2023-01-17T22:00",
            "2023-01-17T23:00",
            "2023-01-18T00:00",
            "2023-01-18T01:00",
            "2023-01-18T02:00",
            "2023-01-18T03:00",
            "2023-01-18T04:00",
            "2023-01-18T05:00",
            "2023-01-18T06:00",
            "2023-01-18T07:00",
            "2023-01-18T08:00",
            "2023-01-18T09:00",
            "2023-01-18T10:00",
            "2023-01-18T11:00",
            "2023-01-18T12:00",
            "2023-01-18T13:00",
            "2023-01-18T14:00",
            "2023-01-18T15:00",
            "2023-01-18T16:00",
            "2023-01-18T17:00",
            "2023-01-18T18:00",
            "2023-01-18T19:00",
            "2023-01-18T20:00",
            "2023-01-18T21:00",
            "2023-01-18T22:00",
            "2023-01-18T23:00",
            "2023-01-19T00:00",
            "2023-01-19T01:00",
            "2023-01-19T02:00",
            "2023-01-19T03:00",
            "2023-01-19T04:00",
            "2023-01-19T05:00",
            "2023-01-19T06:00",
            "2023-01-19T07:00",
            "2023-01-19T08:00",
            "2023-01-19T09:00",
            "2023-01-19T10:00",
            "2023-01-19T11:00",
            "2023-01-19T12:00",
            "2023-01-19T13:00",
            "2023-01-19T14:00",
            "2023-01-19T15:00",
            "2023-01-19T16:00",
            "2023-01-19T17:00",
            "2023-01-19T18:00",
            "2023-01-19T19:00",
            "2023-01-19T20:00",
            "2023-01-19T21:00",
            "2023-01-19T22:00",
            "2023-01-19T23:00",
        ],
        "temperature_2m": [
            8.0,
            7.8,
            7.5,
            7.5,
            7.5,
            7.4,
            7.7,
            7.6,
            7.3,
            7.7,
            8.3,
            8.7,
            9.6,
            9.7,
            9.7,
            9.8,
            9.1,
            8.3,
            8.0,
            7.3,
            6.8,
            6.1,
            5.8,
            6.0,
            6.6,
            7.4,
            8.5,
            8.9,
            9.4,
            9.8,
            9.6,
            9.5,
            10.2,
            11.0,
            11.5,
            12.1,
            12.3,
            12.0,
            11.2,
            10.4,
            9.1,
            8.0,
            7.2,
            6.8,
            6.5,
            6.2,
            5.8,
            5.6,
            5.3,
            5.0,
            4.5,
            4.1,
            3.7,
            3.8,
            4.2,
            4.3,
            4.6,
            5.0,
            5.5,
            6.2,
            6.9,
            7.6,
            7.7,
            7.5,
            6.9,
            6.1,
            5.4,
            4.6,
            4.2,
            3.9,
            3.6,
            3.7,
            3.6,
            3.2,
            2.8,
            2.4,
            2.6,
            2.8,
            3.0,
            3.0,
            2.9,
            2.7,
            2.8,
            3.4,
            4.1,
            4.6,
            4.8,
            4.5,
            3.7,
            3.0,
            2.2,
            1.6,
            0.9,
            0.4,
            0.1,
            -0.2,
            -0.4,
            -0.7,
            -0.9,
            -1.2,
            -1.4,
            -1.6,
            -1.8,
            -2.0,
            -2.3,
            -2.3,
            -1.9,
            -1.2,
            -0.5,
            -0.1,
            0.2,
            0.4,
            0.2,
            -0.2,
            -0.7,
            -0.9,
            -0.9,
            -1.1,
            -1.4,
            -1.7,
            -2.2,
            -2.5,
            -2.9,
            -3.1,
            -3.2,
            -3.1,
            -2.9,
            -2.7,
            -2.4,
            -1.7,
            -0.8,
            0.3,
            1.4,
            1.9,
            2.2,
            2.2,
            2.0,
            1.5,
            1.0,
            0.9,
            0.6,
            0.2,
            -0.1,
            -0.4,
            -0.7,
            -1.0,
            -1.3,
            -1.6,
            -1.7,
            -1.7,
            -1.6,
            -1.7,
            -1.8,
            -1.6,
            -0.8,
            0.3,
            1.4,
            1.7,
            1.7,
            1.6,
            1.4,
            1.2,
            1.1,
            1.2,
            1.6,
            2.0,
            2.3,
            2.7,
        ],
        "apparent_temperature": [
            3.4,
            3.2,
            2.7,
            2.5,
            2.3,
            2.3,
            2.5,
            2.5,
            2.5,
            3.0,
            3.2,
            3.3,
            4.2,
            4.4,
            4.6,
            5.1,
            5.1,
            4.5,
            4.2,
            3.4,
            3.2,
            2.8,
            2.6,
            3.0,
            3.5,
            4.3,
            5.3,
            5.8,
            6.0,
            5.8,
            5.0,
            4.7,
            5.8,
            6.6,
            7.8,
            8.7,
            9.3,
            7.8,
            7.0,
            6.1,
            4.5,
            3.3,
            2.4,
            2.0,
            1.7,
            1.4,
            1.1,
            1.0,
            0.5,
            0.4,
            -0.2,
            -0.9,
            -1.5,
            -1.6,
            -1.4,
            -1.1,
            -0.9,
            -0.2,
            0.5,
            0.9,
            1.8,
            2.6,
            2.8,
            3.0,
            2.7,
            2.4,
            2.1,
            1.7,
            1.2,
            1.2,
            1.0,
            1.1,
            1.1,
            0.9,
            0.6,
            0.3,
            0.3,
            0.3,
            0.2,
            -0.1,
            -0.7,
            -1.0,
            -1.1,
            -0.6,
            0.1,
            0.0,
            0.3,
            -0.2,
            -0.6,
            -1.3,
            -1.7,
            -2.1,
            -2.6,
            -3.1,
            -3.4,
            -3.6,
            -3.8,
            -4.0,
            -4.2,
            -4.4,
            -4.5,
            -4.7,
            -4.9,
            -5.1,
            -5.4,
            -5.4,
            -5.0,
            -4.3,
            -3.7,
            -3.4,
            -3.1,
            -3.0,
            -3.1,
            -3.4,
            -3.8,
            -3.9,
            -4.0,
            -4.2,
            -4.6,
            -5.0,
            -5.6,
            -6.0,
            -6.4,
            -6.6,
            -6.8,
            -6.7,
            -6.6,
            -6.4,
            -6.1,
            -5.5,
            -4.8,
            -3.9,
            -2.9,
            -2.4,
            -1.9,
            -1.8,
            -2.0,
            -2.6,
            -3.1,
            -3.6,
            -3.8,
            -4.0,
            -4.3,
            -4.5,
            -4.8,
            -5.0,
            -5.3,
            -5.5,
            -5.5,
            -5.5,
            -5.3,
            -5.3,
            -5.4,
            -5.0,
            -4.3,
            -3.2,
            -2.0,
            -1.6,
            -1.6,
            -1.6,
            -1.8,
            -2.1,
            -2.4,
            -2.3,
            -2.0,
            -1.7,
            -1.5,
            -1.1,
        ],
        "precipitation": [
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.10,
            0.70,
            1.30,
            1.50,
            1.20,
            0.70,
            1.00,
            0.70,
            0.30,
            0.30,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.00,
            0.50,
            0.50,
        ],
        "weathercode": [
            2,
            2,
            2,
            2,
            3,
            3,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            2,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            61,
            61,
            61,
            61,
            61,
            61,
            61,
            61,
            61,
            61,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            2,
            1,
            2,
            2,
            2,
            2,
            3,
            3,
            3,
            3,
            2,
            2,
            3,
            2,
            2,
            3,
            1,
            3,
            3,
            2,
            3,
            3,
            3,
            3,
            45,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            2,
            2,
            2,
            3,
            3,
            2,
            2,
            2,
            2,
            1,
            1,
            0,
            0,
            0,
            0,
            0,
            0,
            2,
            2,
            2,
            3,
            3,
            3,
            2,
            2,
            2,
            3,
            3,
            3,
            2,
            2,
            2,
            3,
            3,
            3,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            3,
            3,
            3,
            1,
            1,
            1,
            3,
            3,
            3,
            1,
            1,
            1,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            0,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            3,
            61,
            61,
        ],
    },
}

SAMPLE_RESULT = [
    {
        "date": "2023-01-13",
        "hours": [
            {
                "time": "00:00",
                "temperature_2m": 8.0,
                "apparent_temperature": 3.4,
                "precipitation": 0.0,
                "weathercode": 2,
            }
        ],
    }
]


def test_format_data():
    assert format_data(SAMPLE_DATA) == SAMPLE_RESULT
